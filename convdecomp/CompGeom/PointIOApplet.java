package CompGeom;
import java.applet.Applet;
import java.awt.*;

public abstract class PointIOApplet extends Applet {

  static PointList pts = new PointList(500);
  static Anim2D result = null;
  static boolean detail = false;
  static boolean animating = false;

  private Button clear_button = new Button("Clear All");
  private Button delete_button = new Button("Delete Last");
  private Button anim_button = new Button("Animate");
  private Button detail_button = new Button("Detail");
  private Button random_button = new Button("Random");
  private Button update_button = new Button("Update");

  final public boolean animating() { return animating; }

  public void init() {
    Panel p=new Panel();
    setLayout(new BorderLayout());
    setBackground(Color.white);
    setForeground(Color.black);
    addbuttons(p);
    add("South",p);
	
	/*
	pts.add(30, 30);
	pts.add(65, 60);
	pts.add(85, 120);
	pts.add(95, 50);
	pts.add(125, 40);
	pts.add(120, 25);
	*/
	
	int[] points = {
//61,0,53,3,48,8,45,17,39,23,39,27,42,30,41,45,46,49,52,48,54,50,54,60,43,58,34,48,25,47,12,60,10,68,7,60,0,63,0,66,4,69,1,81,6,87,13,89,24,120,27,122,27,125,24,127,22,155,18,162,16,162,15,171,21,175,24,185,32,190,36,190,39,187,39,176,36,168,42,151,45,151,45,160,39,167,39,173,44,177,45,185,48,188,54,190,61,189,62,182,59,168,62,168,60,163,62,162,63,152,67,152,69,148,67,123,72,108,75,105,75,91,78,88,81,76,87,75,87,73,98,66,102,54,104,51,107,51,110,42,108,37,104,36,105,22,108,20,109,15,106,9,99,8,93,13,93,5,91,3,62,0};
//31,0,31,5,25,5,25,17,19,17,19,36,31,36,31,43,12,43,12,49,0,49,0,62,6,62,6,68,12,68,12,62,25,62,25,68,12,68,12,74,6,74,6,86,19,86,19,80,63,80,63,74,99,74,99,43,95,43,95,49,88,49,88,56,75,56,75,49,81,49,81,42,88,42,88,30,95,30,95,0,75,0,75,5,63,5,63,0,32,0};
//10,19,10,46,91,40,95,61,94,64,10,88,10,140,30,140,33,126,83,120,87,121,72,140,128,140,126,130,191,132,199,62,173,61,173,95,46,109,38,109,34,95,153,81,154,62,123,64,118,39,219,39,219,19,11,19};
//490,6,277,11,42,10,43,42,178,31,182,52,181,55,68,88,92,198,164,286,161,290,144,299,146,305,162,327,167,324,181,307,193,323,172,377,147,342,107,339,105,479,140,478,139,373,177,421,220,425,243,397,211,361,310,372,255,354,120,220,105,183,108,163,120,117,174,111,151,140,120,140,118,184,178,183,212,170,192,199,177,236,215,262,225,265,260,271,286,245,289,241,289,233,285,193,407,187,246,313,246,315,258,320,385,364,388,367,65,529,52,453,83,490,92,350,53,298,35,257,129,325,132,326,132,324,14,47,110,290,110,292,107,291,16,218,29,303,72,339,73,458,34,410,45,552,104,529,389,408,392,408,389,419,379,423,376,429,370,428,368,433,369,554,375,553,375,442,387,448,381,463,381,472,389,480,389,532,391,543,396,541,396,483,404,483,413,478,423,468,424,462,427,460,432,460,432,520,438,521,439,456,443,455,452,445,454,438,459,442,461,450,466,455,474,459,485,457,487,463,492,467,492,511,498,511,498,470,506,468,511,463,513,460,513,450,502,426,495,418,484,411,487,381,484,378,483,369,554,340,556,337,342,309,333,306,527,154,539,142,410,60,365,48,362,48,365,55,370,60,417,136,375,94,334,170,326,142,218,147,213,121,278,123,286,53,260,52,260,86,133,100,125,100,121,87,138,83,240,72,241,53,210,55,205,30,536,33,538,6,491,6};
//195,2,193,16,196,30,196,46,193,61,187,72,185,72,181,46,175,35,162,20,154,19,144,12,139,12,138,16,143,18,156,66,143,44,123,26,115,22,96,23,96,28,102,31,104,36,120,54,138,89,120,76,82,59,66,57,55,60,57,67,64,76,117,108,137,117,110,120,67,120,45,129,45,133,48,136,75,145,92,145,136,137,100,159,79,180,73,191,63,196,62,199,81,201,99,197,114,189,146,164,136,179,130,193,127,208,129,228,137,230,156,215,167,200,176,178,183,209,193,223,204,233,193,270,164,330,165,311,163,311,163,305,156,294,129,273,111,253,105,252,111,262,113,281,127,305,142,323,143,330,150,343,150,349,130,370,129,376,132,378,137,378,150,365,174,334,189,302,193,298,203,271,210,264,258,250,258,247,274,239,276,234,290,225,290,220,299,213,302,207,314,200,314,197,308,198,284,212,278,212,275,217,265,222,259,221,252,229,240,232,232,238,217,243,211,250,217,225,216,212,218,211,216,210,217,204,214,194,214,189,216,188,212,186,210,175,241,206,264,211,269,209,266,195,252,176,270,183,276,188,289,188,292,190,298,188,297,177,287,165,239,138,249,141,318,145,318,140,296,121,243,113,270,104,301,85,311,76,314,59,309,57,302,65,283,75,257,84,241,87,226,94,248,62,257,53,263,38,263,22,257,19,250,26,244,28,235,37,228,52,214,69,219,51,215,18,205,5,196,2};

// poly2
//105,1,82,54,80,54,73,40,54,45,83,27,80,26,58,35,69,8,53,31,24,22,49,40,29,56,27,60,53,50,66,67,61,49,76,56,79,60,55,113,37,106,45,100,54,84,52,82,43,93,47,77,44,78,30,100,20,96,14,108,15,111,22,115,14,126,13,131,23,135,33,117,48,126,48,129,7,217,7,221,73,226,9,325,8,330,74,365,87,373,87,375,84,376,4,334,63,375,3,344,6,394,80,395,17,377,13,378,52,391,11,389,11,358,13,358,89,397,197,390,200,388,196,375,232,397,329,394,374,398,386,380,369,376,371,368,374,366,389,366,384,281,381,281,366,292,363,275,351,285,336,282,270,304,268,307,282,318,309,316,310,314,289,309,286,306,335,287,356,290,359,285,363,308,375,304,379,348,378,354,361,361,358,380,372,385,368,389,236,393,208,364,204,362,206,373,194,360,192,360,184,375,188,380,141,385,136,386,137,389,127,390,99,391,94,388,102,389,123,381,120,359,118,358,103,373,101,372,53,285,98,237,98,233,81,205,79,195,75,191,69,190,60,195,50,195,49,185,66,167,75,135,81,126,92,116,100,84,117,64,119,56,118,46,177,67,183,41,193,74,115,78,92,206,111,225,111,240,184,237,151,249,149,249,151,243,146,248,138,243,139,251,117,258,114,258,117,250,113,251,108,257,99,254,103,261,87,268,85,268,84,263,78,270,70,288,83,280,96,282,90,273,104,267,102,274,112,268,119,271,116,263,141,255,139,265,150,259,164,261,155,252,200,235,235,233,244,105,171,106,169,107,163,137,137,135,123,197,142,213,203,212,197,200,152,200,139,187,145,159,152,160,150,187,179,194,184,194,198,160,205,160,206,168,197,175,192,185,193,191,196,194,204,196,209,191,208,187,204,184,206,183,211,188,217,183,215,173,218,165,215,155,212,153,212,148,218,147,220,141,216,137,209,137,204,140,195,130,224,138,224,147,216,221,135,225,112,198,133,96,259,100,254,234,333,173,303,263,280,252,276,252,233,304,234,310,247,330,223,335,229,263,225,263,223,289,221,289,221,307,219,307,218,311,218,323,215,324,215,337,209,339,207,338,217,275,208,276,210,288,209,304,208,311,206,312,203,340,200,341,196,341,196,338,201,291,191,308,191,313,168,345,188,281,108,308,105,308,100,295,290,236,87,292,112,342,115,342,151,317,140,378,209,354,244,390,279,383,276,362,254,352,265,369,248,370,234,348,265,339,300,379,344,384,345,348,331,342,333,360,325,368,301,343,337,330,354,357,370,343,370,339,338,293,321,299,326,318,310,325,268,325,259,306,285,271,309,290,312,290,320,272,328,280,341,281,350,275,352,268,360,267,364,259,369,259,370,265,374,268,381,268,385,264,385,257,382,253,388,244,388,234,382,224,378,222,379,214,374,209,366,210,363,215,364,220,356,223,351,228,348,234,350,253,341,248,331,247,360,187,360,182,357,180,358,177,362,175,371,197,376,197,365,171,367,167,369,167,387,202,395,203,372,160,376,156,388,178,392,180,395,174,378,148,383,140,390,154,397,151,371,103,366,106,366,109,381,132,378,137,361,109,357,111,357,115,373,146,370,146,343,106,339,114,368,156,364,160,340,122,336,125,336,129,362,164,359,164,335,132,329,135,329,138,357,167,357,170,352,174,334,150,328,147,273,187,282,139,333,127,330,44,241,43,253,63,315,67,312,109,290,109,289,75,222,83,228,25,334,30,352,111,355,111,373,98,375,92,343,11,210,6,200,37,168,6,165,6,150,45,106,1};
// monkey
//80,5,64,8,50,24,46,33,43,62,30,65,21,71,12,70,9,64,5,64,5,70,2,74,8,77,9,75,25,75,34,69,44,66,47,66,51,73,31,87,16,87,5,80,4,87,0,91,5,89,6,93,6,91,10,92,10,89,14,89,23,93,34,92,45,86,53,78,59,77,72,94,71,101,62,112,47,101,37,101,29,106,22,115,13,120,11,128,16,123,16,135,18,126,24,132,20,127,20,123,26,127,23,123,23,117,34,106,44,104,59,115,58,125,64,129,59,140,47,148,38,147,34,142,38,140,39,133,37,132,37,138,34,138,33,131,32,136,30,136,28,130,28,141,22,135,25,141,22,146,31,145,40,151,51,151,64,141,68,131,69,133,75,133,74,130,79,128,82,123,82,118,74,111,74,107,70,112,67,112,77,99,77,92,73,83,48,60,55,46,55,35,59,21,64,15,73,10,94,10,102,15,109,27,109,45,102,53,93,56,79,55,71,50,68,46,66,33,70,25,75,20,81,18,94,19,100,25,102,37,99,44,95,47,88,49,78,47,73,40,73,32,78,25,88,23,95,28,95,38,90,42,83,42,79,38,79,33,83,29,89,29,91,34,88,37,84,36,84,34,88,33,87,31,82,33,82,37,88,40,92,36,91,28,83,27,78,30,76,39,81,44,91,44,98,37,96,25,91,21,84,20,75,24,70,31,70,41,73,46,78,50,88,52,98,49,104,42,105,28,101,20,95,15,83,14,71,19,62,31,62,41,67,51,79,59,87,60,104,57,111,51,113,47,113,27,108,16,96,7,81,5};
//monkey2
//43,62,30,65,21,71,12,70,9,64,5,64,5,70,2,74,8,77,9,75,25,75,34,69,44,66,47,66,51,73,31,87,16,87,5,80,4,87,0,91,5,89,6,93,6,91,10,92,10,89,14,89,23,93,34,92,45,86,53,78,59,77,72,94,71,101,62,112,47,101,37,101,29,106,22,115,13,120,11,128,16,123,16,135,18,126,24,132,20,127,20,123,26,127,23,123,23,117,34,106,44,104,59,115,58,125,64,129,59,140,47,148,38,147,34,142,38,140,39,133,37,132,37,138,34,138,33,131,32,136,30,136,28,130,28,141,22,135,25,141,22,146,31,145,40,151,51,151,64,141,68,131,69,133,75,133,74,130,79,128,82,123,82,118,74,111,74,107,70,112,67,112,77,99,77,92,73,83,48,60,55,46,55,35,59,21,64,15,73,10,94,10,102,15,109,27,109,45,102,53,93,56,79,55,71,50,68,46,66,33,70,25,75,20,81,18,94,19,100,25,102,37,99,44,95,47,88,49,78,47,73,40,73,32,78,25,88,23,95,28,95,38,90,42,83,42,79,38,79,33,83,29,89,29,91,34,88,37,84,36,84,34,88,33,87,31,82,33,82,37,88,40,92,36,91,28,83,27,78,30,76,39,81,44,91,44,98,37,96,25,91,21,84,20,75,24,70,31,70,41,73,46,78,50,88,52,98,49,104,42,105,28,101,20,95,15,83,14,71,19,62,31,62,41,67,51,79,59,87,60,104,57,111,51,113,47,113,27,108,16,96,7,81,5,65,8,64,8,50,24,46,33};
//mario
//31,0,31,5,25,5,25,17,19,17,19,36,31,36,31,43,12,43,12,49,0,49,0,62,6,62,6,68,12,68,12,62,25,62,25,68,12,68,12,74,6,74,6,86,19,86,19,80,63,80,63,74,99,74,99,43,95,43,95,49,88,49,88,56,75,56,75,49,81,49,81,42,88,42,88,30,95,30,95,0,75,0,75,5,63,5,63,0,32,0};
//monkey_part
//36,12,27,21,21,33,19,61,5,65,0,69,0,74,2,74,9,69,22,66,26,73,9,86,0,87,0,93,12,91,30,77,34,77,36,80,36,71,23,60,30,46,30,35,36,20};
//issue11
//0,0,300,280,200,300,150,350,0,400,400,400,400,0};
//pirate
//61,0,53,3,48,8,45,17,39,23,39,27,42,30,41,45,46,49,52,48,54,50,54,60,43,58,34,48,25,47,12,60,10,68,7,60,0,63,0,66,4,69,1,81,6,87,13,89,24,120,27,122,27,125,24,127,22,155,18,162,16,162,15,171,21,175,24,185,32,190,36,190,39,187,39,176,36,168,42,151,45,151,45,160,39,167,39,173,44,177,45,185,48,188,54,190,61,189,62,182,59,168,62,168,60,163,62,162,63,152,67,152,69,148,67,123,72,108,75,105,75,91,78,88,81,76,87,75,87,73,98,66,102,54,104,51,107,51,110,42,108,37,104,36,105,22,108,20,109,15,106,9,99,8,93,13,93,5,91,3,62,0};
//big
//106,2,82,57,72,41,47,48,74,31,72,30,57,36,64,17,54,32,30,25,51,40,34,55,53,48,63,61,60,51,61,47,81,59,55,115,35,106,47,94,46,92,41,96,44,82,30,102,23,98,19,100,16,110,22,112,23,115,14,130,23,134,32,116,40,119,50,127,8,218,8,220,74,225,71,233,9,329,87,371,90,375,88,378,85,378,22,345,80,385,78,386,4,345,7,394,74,394,51,387,47,388,58,392,10,390,10,356,12,356,89,396,197,389,198,385,194,377,194,374,196,374,233,396,343,394,373,397,384,380,369,377,370,368,376,365,388,365,384,293,382,282,365,294,363,276,351,286,336,283,271,305,270,307,282,317,306,315,282,308,282,306,335,286,355,289,359,283,364,307,372,303,376,304,380,354,362,362,359,376,360,380,373,384,369,390,234,393,207,365,206,369,209,376,194,362,192,362,186,374,189,381,141,386,138,387,138,390,98,392,78,380,80,379,101,388,122,379,119,360,101,375,52,288,56,280,93,241,97,234,74,194,69,193,59,198,50,197,47,194,47,186,66,161,72,135,90,114,98,82,115,62,116,44,176,66,181,38,183,38,194,75,116,78,93,206,112,225,112,240,190,236,149,251,147,251,148,248,145,250,140,246,139,252,114,260,112,260,114,253,109,258,102,256,105,262,88,269,84,269,83,266,78,272,73,285,83,279,93,280,88,273,94,270,104,266,107,266,105,271,111,267,117,269,115,262,134,256,143,254,141,263,151,257,160,259,152,254,152,252,197,235,234,233,243,106,170,107,164,138,138,136,124,192,124,196,144,213,202,212,198,201,151,200,138,187,144,158,153,159,151,186,183,193,198,158,205,157,209,168,195,183,195,189,200,193,204,193,206,189,202,187,202,183,207,180,208,184,213,185,215,182,213,178,215,163,212,155,209,153,209,147,216,145,217,142,215,139,211,139,203,143,197,134,190,133,187,135,184,138,184,142,187,144,194,140,197,146,187,149,178,161,180,163,185,162,192,153,196,153,197,158,180,175,168,175,179,125,222,136,225,137,225,147,217,221,134,226,111,199,132,96,260,100,255,232,334,171,304,264,276,253,234,305,248,331,222,336,227,264,224,275,224,290,222,290,222,308,219,311,219,323,216,325,216,337,206,340,216,278,216,276,213,276,209,277,211,294,204,341,196,343,200,295,193,307,194,311,181,327,180,333,166,349,187,282,108,309,104,309,99,297,99,294,190,265,88,293,113,341,152,315,141,377,209,353,244,389,279,382,276,363,256,354,266,369,247,371,233,349,233,346,266,338,300,378,343,384,346,350,332,343,334,360,325,369,300,343,300,341,338,329,356,356,369,342,338,294,322,300,327,319,312,325,267,325,258,306,284,270,311,289,321,267,328,277,339,279,348,273,350,263,357,265,360,262,361,258,359,255,373,256,372,262,375,265,382,263,381,256,377,254,384,247,385,235,383,230,373,223,376,220,374,212,369,212,366,215,366,219,369,222,359,224,352,232,351,244,357,254,354,253,348,258,340,250,329,252,359,186,356,178,361,173,371,195,375,196,364,172,367,165,370,166,387,200,393,202,374,168,371,158,376,154,389,177,392,178,394,174,377,151,377,148,382,138,385,140,391,153,395,151,395,148,370,105,367,108,382,131,382,135,378,140,361,110,358,114,375,145,374,147,369,147,345,109,343,108,341,111,341,115,368,152,369,156,366,161,362,159,340,124,337,126,363,161,362,167,359,166,335,133,330,136,359,168,354,175,347,170,329,148,272,189,281,139,332,126,329,44,243,44,253,62,316,66,313,109,289,109,288,76,221,84,227,24,334,29,354,110,371,98,374,93,343,12,211,7,202,38,200,38,166,7,153,44,150,46,107,2};
//big part
33,3,16,10,14,10,15,7,12,9,7,5,7,10,0,12,0,16,10,13,8,22,18,16,27,18,19,13,19,11,32,7,33,3};
        
	int len = points.length;
	double scale = 2.;
	for (int i=0; i<len; i+=2) {
		pts.add(new Point(points[i]*scale /*+ 10*/, -(points[i+1]*scale /*+ 10*/)));
	}
	//pts.add(points[0],4);
	repaint();
  }

  void addbuttons(Panel p) {
    p.add(clear_button);
    p.add(delete_button);
    p.add(detail_button);
    p.add(anim_button);
    p.add(random_button);
    p.add(update_button);
  }

  boolean handlebuttons(Object target){
    if (target == clear_button) { pts.removeAll(); result = null; }
    else if (target == delete_button) { pts.deleteLast(); result = null; }
    else if (target == detail_button) detail = !detail;
    else if (target == anim_button) { animating = !animating; }
    else if (target == random_button) { 
      pts.random(30, 350, 350);  result = null; 
    }
    else if (target == update_button) {
      if (!pts.isEmpty()) {
	CompGeom.Point.reset();
	result = null;
	result = compute(pts);
	System.out.println(CompGeom.Point.stats());
      }
    }
    else return false;
    update(getGraphics());
    return true;
  }

  public boolean action(Event e, Object obj){
    if (e.target instanceof Button) return handlebuttons(e.target);
    return true;
  }

  public boolean mouseDown(Event e, int x, int y){
    Graphics g = getGraphics();
    g.setColor(Color.black);
    g.fillOval(x-3, y-3, 6, 6);
    pts.add(x, y);
    result = null;
    repaint();
    return true;
  }

  public void animate(Anim2D pa) {
    if (animating()) pa.register(getGraphics());
  }

  public String getAppletInfo() {
    return "Computational Geometry demonstration applet\n" +
      "Jack Snoeyink\nversion 1.0 January 1996";
  }

  static public void makeStandalone(String title, PointIOApplet ap, 
			     int width, int height)
 {
    Frame f = new Frame(title);
    ap.init();
    ap.start();
    f.add("Center", ap);
    f.resize(width, height);
    f.show();
  }
//Example of use in derived class:
//public static void main(String args[]);
// { makeStandalone("Jarvis march", new Jarvis(), 350, 350); }

  public void paint(Graphics g){
    g.setColor(Color.red);
    pts.draw(g, detail);
    pts.drawPolyline(g, pts.number());
    g.setColor(Color.blue);
    if (result != null) result.draw(g, detail);
  }

  public abstract Anim2D compute(PointList pl);
}
